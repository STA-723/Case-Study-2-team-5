---
title: "Exploratory Analysis of Data for Airbnb Listings in NYC"
author: "Youngsoo Baek, Irene Yi Ji, Phuc Nguyen"
output: beamer_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(dplyr)
library(ggplot2)
library(lubridate)
# Dataset we are using (ref. to as airbnb)
airbnb <- read.csv("./AB_NYC_2019.csv") %>% 
    mutate(price = ifelse(price==0, 5, price),
           reviews_per_month = ifelse(is.na(reviews_per_month), 0, reviews_per_month),
           last_review = 2019 - year(ymd(last_review)),
           available_spec = (availability_365 != 0) ) %>%
    # available_spec does not actually mean "available," but rather two diff. groups
    # that have specified the variable or not
    # Whichever listings without any review will have NA values!
    filter(minimum_nights <= 365)
```

### Introduction

* Data: Airbnb New York City open data collected from 2019, with 48,895 listings and 16 variables.  
  
* Goals:  
  + Identify most influential factors for price/popularity  
  + Examine heterogeneity across boroughs and neighbourhoods  
  + Recommend best location and name for airbnb

### Data Processing

* Remove 14 observations with *minimum_nights* > 365
* *Price*: the lowest non-zero value is 10, added 5 to 0's 
* *Reviews per Month*: missing values are set to 0 (last review dates are missing and total number of reviews are 0)
* *Last Review*: group by years from 2019 (e.g. 2019 -> 0; 2018 -> 1, etc.)
* *availability_365*: create a new variable *available_spec* to indicate whether the value is 0

### EDA - Heterogeneity across Boroughs (Price)
```{r message=FALSE, echo=FALSE, out.width = '90%',fig.align = "center"}
library(cowplot)
p1 <- ggdraw() + draw_image("figures/Boxplot_PriceBoroughs.png")
p2 <- ggdraw() + draw_image("figures/Mosaic_PriceLevelBoroughs.png")
pp1<- plot_grid(p1, p2)
ggdraw(pp1)
```
  
* Generate 3 price levels:  
"below Q1", "between Q1 and Q3", "above Q3"  
  
* Pearson's Chi-squared test: p-value < 2.2e-16

### EDA - Heterogeneity across Boroughs (Popularity)
```{r message=FALSE, echo=FALSE, out.width = '90%',fig.align = "center"}
p1 <- ggdraw() + draw_image("figures/Boxplot_MonthlyReviewBoroughs.png")
p2 <- ggdraw() + draw_image("figures/Mosaic_PopularityLevelBoroughs.png")
pp1<- plot_grid(p1, p2)
ggdraw(pp1)
```
    
* Generate 3 popularity levels:  
"below Q1", "between Q1 and Q3", "above Q3"   
  
* Pearson's Chi-squared test: p-value < 2.2e-16

### EDA - Heterogeneity across Boroughs (Room Type)
```{r message=FALSE, echo=FALSE, out.width = '70%',fig.align = "center"}
p1 <- ggdraw() + draw_image("figures/Mosaic_RoomTypeBoroughs.png")
pp1<- plot_grid(p1)
ggdraw(pp1)
```

* Pearson's Chi-squared test: p-value < 2.2e-16

### EDA - XGBoost for Important Variables (Price)
```{r message=FALSE, echo=FALSE, out.width = '75%',fig.align = "center"}
p1 <- ggdraw() + draw_image("figures/XGBoost_LogPrice.png")
pp1<- plot_grid(p1)
ggdraw(pp1)
```

* The most influential factors for price of airbnb include: room type (private room), availability, monthly reviews, boroughs (Manhattan), etc.

### EDA - XGBoost for Important Variables (Popularity)
```{r message=FALSE, echo=FALSE, out.width = '75%',fig.align = "center"}
p1 <- ggdraw() + draw_image("figures/XGBoost_LogMonthlyReview.png")
pp1<- plot_grid(p1)
ggdraw(pp1)
```

* The most influential factors for popularity of airbnb include: last review (in years from 2019), availability, minimum nights, price, etc.

### EDA - Price and Popularity

* From XGBoost outputs, price and popularity are closely related, both being an important variable of the other.  

* The plot below shows a negative correlation between them:

```{r message=FALSE, echo=FALSE, out.width = '70%',fig.align = "center"}
p1 <- ggdraw() + draw_image("figures/MonthlyReview_Price.png")
pp1<- plot_grid(p1)
ggdraw(pp1)
```
* We may consider model them as bivariate reponse.

## Response of Interest: Price and Popularity

## Choosing a Meaningful Measure of Popularity

## Heterogeneity across Neighbourhoods/Boroughs

## Spatial Correlation

## Predictors of Interest

## Possibly Unreliable Predictors

## Modeling

## Price and Popularity: Bivariate Mixed Effects Regression

## Did We Miss Spatial Correlation Within Neighbourhoods?

## Text Analysis for Listing Names

## Further Work
